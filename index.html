<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vince's Planning Poker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-red-800 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">
                    <i class="fas fa-layer-group mr-2"></i>
                    Vince's Planning Poker
                </h1>
                <div id="sessionInfo" class="hidden">
                    <span class="mr-4">Session: <span id="sessionId"></span></span>
                    <button id="copyLinkBtn" class="bg-red-700 hover:bg-red-900 px-4 py-2 rounded transition">
                        <i class="fas fa-share-alt mr-2"></i>Copy Link
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Start Session View -->
        <div id="startView" class="max-w-2xl mx-auto">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">Welcome to Planning Poker</h2>
                
                <!-- Join Session Section (Default) -->
                <div id="joinSectionDefault">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                            <input type="text" id="userName" placeholder="Enter your name" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-700 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Session ID</label>
                            <input type="text" id="sessionIdInput" placeholder="Enter session ID" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-700 focus:border-transparent">
                        </div>
                        
                        <button id="joinBtn" class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-3 px-6 rounded-lg transition">
                            <i class="fas fa-sign-in-alt mr-2"></i>Join Session
                        </button>
                    </div>
                </div>
                
                <!-- Create Session Section (Hidden by default) -->
                <div id="createSection" class="hidden">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                            <input type="text" id="userNameCreate" placeholder="Enter your name" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-700 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Deck Type</label>
                            <select id="deckType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-700 focus:border-transparent">
                                <option value="modified" selected>Modified Fibonacci (0, Â½, 1, 2, 3, 5, 8, 13, 20, 40, 100)</option>
                                <option value="fibonacci">Fibonacci (0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89)</option>
                                <option value="tshirt">T-Shirt Sizes (XS, S, M, L, XL, XXL)</option>
                                <option value="sequential">Sequential (1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</option>
                            </select>
                        </div>
                        
                        <button id="createSessionBtn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition">
                            <i class="fas fa-plus-circle mr-2"></i>Create Session
                        </button>
                    </div>
                </div>
                
                <!-- Toggle Button -->
                <div class="mt-6 text-center">
                    <button id="toggleModeBtn" class="text-red-700 hover:text-red-800 font-medium transition">
                        <i class="fas fa-exchange-alt mr-2"></i>Want to create a session instead?
                    </button>
                </div>
            </div>
        </div>

        <!-- Game View -->
        <div id="gameView" class="hidden">
            <!-- Header with Current Item and Stats -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex justify-between items-center">
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Current Item</h3>
                        <div id="votingItemDisplay" class="p-4 bg-red-50 rounded-lg">
                            <p class="text-lg font-semibold text-red-800">Select an item to start voting</p>
                        </div>
                    </div>
                    <div id="voteStats" class="hidden ml-6 text-right">
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Vote Statistics</h4>
                        <div class="bg-gray-100 rounded-lg p-4">
                            <div id="statsContent">
                                <!-- Stats will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Participants Grid -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h3 class="text-xl font-bold mb-4 text-gray-800">
                    <i class="fas fa-users mr-2"></i>Participants
                </h3>
                <div id="participantsGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                    <!-- Participant cards will be added here -->
                </div>
            </div>

            <!-- Admin Panel (collapsible) -->
            <div id="adminPanel" class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">
                        <i class="fas fa-cog mr-2"></i>Admin Panel
                    </h3>
                    <button id="toggleAdminPanel" class="text-gray-600 hover:text-gray-800">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                
                <div id="adminPanelContent">
                    <!-- Item Management -->
                    <div class="mb-6">
                        <!-- Centered Add Item Section -->
                        <div class="flex flex-col items-center mb-4">
                            <h4 class="font-semibold text-gray-700 mb-3">Add New Item</h4>
                            <div class="flex w-full max-w-md space-x-2">
                                <input type="text" id="newItemInput" placeholder="Enter item description..." 
                                       class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-700 focus:border-transparent text-base">
                                <button id="addItemBtn" class="bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-6 rounded-lg transition whitespace-nowrap">
                                    <i class="fas fa-plus mr-2"></i>Add
                                </button>
                            </div>
                        </div>
                        
                        <!-- Items List -->
                        <h4 class="font-semibold text-gray-700 mb-3 border-t pt-4">Items to Vote On</h4>
                        <div id="itemsList" class="space-y-2 max-h-48 overflow-y-auto">
                            <!-- Items will be added here -->
                        </div>
                    </div>
                    
                    <!-- Control Buttons -->
                    <div class="flex flex-wrap gap-2">
                        <button id="revealVotesBtn" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded transition">
                            <i class="fas fa-eye mr-2"></i>Reveal Votes
                        </button>
                        <button id="resetVotesBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition">
                            <i class="fas fa-redo mr-2"></i>Reset Votes
                        </button>
                        <button id="nextItemBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition">
                            <i class="fas fa-arrow-right mr-2"></i>Next Item
                        </button>
                    </div>
                </div>
            </div>

            <!-- Voting Cards Section -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold mb-4 text-gray-800">
                    <i class="fas fa-layer-group mr-2"></i>Select Your Vote
                </h3>
                
                <div id="cardsGrid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 mb-4">
                    <!-- Cards will be generated here -->
                </div>
                
                <!-- Selected Card Display -->
                <div id="selectedCardDisplay" class="hidden text-center">
                    <p class="text-sm text-gray-600 mb-2">Your selection:</p>
                    <div id="selectedCard" class="inline-block bg-red-700 text-white text-3xl font-bold py-6 px-10 rounded-lg shadow-lg">
                        <!-- Selected card value -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 hidden">
        <div class="bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="toastMessage"></span>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-database-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="env.js"></script>
    <script src="firebase-config.js"></script>
    <script src="firebase-debug.js"></script>
    
    <!-- Main Application Script -->
    <script src="script-firebase.js"></script>
</body>
</html>
